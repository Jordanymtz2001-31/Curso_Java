--VISTAS COMPLEJAS

CREATE TABLE VENTA_COMPU(
    ID_VENTA NUMBER,
    ID_COMPU NUMBER,
    CANTIDAD NUMBER,
    FECHA DATE,
    CONSTRAINT VENTA_PK PRIMARY KEY(ID_VENTA),
    CONSTRAINT COMPU_FK FOREIGN KEY(ID_COMPU) REFERENCES COMPUTADORA(ID_COMPU)
);

INSERT INTO VENTA_COMPU VALUES (1, 1, 2, DATE '2024-01-15');
INSERT INTO VENTA_COMPU VALUES (2, 3, 1, DATE '2024-01-18');
INSERT INTO VENTA_COMPU VALUES (3, 5, 3, DATE '2024-01-22');
INSERT INTO VENTA_COMPU VALUES (4, 2, 1, DATE '2024-01-25');
INSERT INTO VENTA_COMPU VALUES (5, 7, 2, DATE '2024-02-01');
INSERT INTO VENTA_COMPU VALUES (6, 4, 1, DATE '2024-02-05');
INSERT INTO VENTA_COMPU VALUES (7, 9, 4, DATE '2024-02-10');
INSERT INTO VENTA_COMPU VALUES (8, 6, 2, DATE '2024-02-15');
INSERT INTO VENTA_COMPU VALUES (9, 8, 1, DATE '2024-02-20');
INSERT INTO VENTA_COMPU VALUES (10, 10, 1, DATE '2024-02-25');
INSERT INTO VENTA_COMPU VALUES (11, 12, 3, DATE '2024-03-01');
INSERT INTO VENTA_COMPU VALUES (12, 15, 1, DATE '2024-03-05');
INSERT INTO VENTA_COMPU VALUES (13, 11, 2, DATE '2024-03-10');
INSERT INTO VENTA_COMPU VALUES (14, 13, 1, DATE '2024-03-15');
INSERT INTO VENTA_COMPU VALUES (15, 14, 2, DATE '2024-03-20');
INSERT INTO VENTA_COMPU VALUES (16, 16, 1, DATE '2024-03-25');
INSERT INTO VENTA_COMPU VALUES (17, 18, 3, DATE '2024-04-01');
INSERT INTO VENTA_COMPU VALUES (18, 17, 1, DATE '2024-04-05');
INSERT INTO VENTA_COMPU VALUES (19, 19, 2, DATE '2024-04-10');
INSERT INTO VENTA_COMPU VALUES (20, 20, 1, DATE '2024-04-15');

--MOSTRAR LAS VENTAS
CREATE OR REPLACE VIEW V_VENTA_COMPU AS
SELECT V.ID_VENTA, C.MARCA, C.MODELO, V.CANTIDAD, V.FECHA
FROM VENTA_COMPU V
INNER JOIN COMPUTADORA C
ON V.ID_COMPU = C.ID_COMPU;

SELECT * FROM V_VENTA_COMPU;

--MOSTRAR EL TOTAL VENDIDO POR MARCA
CREATE OR REPLACE VIEW V_TOTAL_VENDIDO AS
SELECT C.MARCA, SUM(V.CANTIDAD) AS TOTAL_VENDIDO
FROM COMPUTADORA C
INNER JOIN VENTA_COMPU V
ON C.ID_COMPU = V.ID_COMPU
GROUP BY C.MARCA;

SELECT * FROM V_TOTAL_VENDIDO







