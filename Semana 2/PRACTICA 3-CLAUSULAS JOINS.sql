--PRACTICA DE JOINS
CREATE TABLE ALUMNO(
    ID_ALUMNO NUMBER,
    NOMBRE NVARCHAR2(50),
    CARRERA NVARCHAR2(50),
    SEMESTRE NUMBER,
    CONSTRAINT ALUM_PK PRIMARY KEY(ID_ALUMNO)
);

CREATE TABLE MATERIA(
    ID_MATERIA NUMBER,
    NOMBRE NVARCHAR2(50),
    CREDITOS NUMBER,
    CONSTRAINT MATERIA_PK PRIMARY KEY(ID_MATERIA)
);

CREATE TABLE INSCRIPCION(
    ID_INSCRIPCION NUMBER,
    ID_ALUMNO NUMBER,
    ID_MATERIA NUMBER,
    CALIFICACION NUMBER,
    CONSTRAINT INSCRIP_PK PRIMARY KEY(ID_INSCRIPCION),
    CONSTRAINT ALUMNO_FK FOREIGN KEY(ID_ALUMNO) REFERENCES ALUMNO(ID_ALUMNO),
    CONSTRAINT MATERIA_FK FOREIGN KEY(ID_MATERIA) REFERENCES MATERIA(ID_MATERIA)
);

INSERT INTO ALUMNO VALUES (1, 'Ana García', 'Ingeniería en Sistemas', 5);
INSERT INTO ALUMNO VALUES (2, 'Carlos López', 'Administración', 3);
INSERT INTO ALUMNO VALUES (3, 'María Rodríguez', NULL, 2);
INSERT INTO ALUMNO VALUES (4, 'Juan Pérez', 'Contaduría', 4);
INSERT INTO ALUMNO VALUES (5, 'Laura Martínez', 'Derecho', NULL);
INSERT INTO ALUMNO VALUES (6, 'Pedro Sánchez', NULL, NULL); 


INSERT INTO MATERIA VALUES (1, 'Base de Datos', 8);
INSERT INTO MATERIA VALUES (2, 'Programación Avanzada', 10);
INSERT INTO MATERIA VALUES (3, 'Matemáticas Financieras', 6);
INSERT INTO MATERIA VALUES (4, 'Derecho Civil', NULL);
INSERT INTO MATERIA VALUES (5, 'Contabilidad', 7);
INSERT INTO MATERIA VALUES (6, 'Física Cuántica', NULL);


INSERT INTO INSCRIPCION VALUES (1, 1, 1, 85);   
INSERT INTO INSCRIPCION VALUES (2, 1, 2, 92);   
INSERT INTO INSCRIPCION VALUES (3, 2, 3, 78);   
INSERT INTO INSCRIPCION VALUES (4, 3, 1, NULL); 
INSERT INTO INSCRIPCION VALUES (5, 4, 5, 88);  
INSERT INTO INSCRIPCION VALUES (6, 5, 4, 95);   
INSERT INTO INSCRIPCION VALUES (7, 2, 5, NULL); 
INSERT INTO INSCRIPCION VALUES (8, NULL, 2, 76); 
INSERT INTO INSCRIPCION VALUES (9, 4, NULL, 81);
INSERT INTO INSCRIPCION VALUES (10, NULL, NULL, NULL);

SELECT * FROM ALUMNO;
SELECT * FROM MATERIA;
SELECT * FROM INSCRIPCION;

--LISTAR EL NOMBRE DE ALUMNOS, LA MATERIA Y LA CALIFICACION DE TODOS LOS ALIMNOS QUE TENGAN MATERIA INSCRITA
SELECT A.NOMBRE AS NOMBRE_ALUMNO, M.NOMBRE AS MATERIA, I.CALIFICACION AS CALIFICACION
FROM INSCRIPCION I
INNER JOIN ALUMNO A ON I.ID_ALUMNO = A.ID_ALUMNO 
INNER JOIN MATERIA M ON M.ID_MATERIA = I.ID_MATERIA;

--MOSTRAR TODOS LOS ALUMNOS Y SI TIENEN MATERIAS INSCRITAS
SELECT A.NOMBRE AS NOMBRE_ALUMNO, M.NOMBRE AS MATERIA
FROM INSCRIPCION I
left JOIN ALUMNO A ON I.ID_ALUMNO = A.ID_ALUMNO 
left JOIN MATERIA M ON M.ID_MATERIA = I.ID_MATERIA;

--MUESTRA TODOS LOS ALUMNOS SIN MATERIAS INSCRITAS
    SELECT A.NOMBRE AS NOMBRE_ALUMNO, M.NOMBRE AS MATERIA
    FROM INSCRIPCION I
    RIGHT JOIN ALUMNO A ON I.ID_ALUMNO = A.ID_ALUMNO 
    FULL JOIN MATERIA M ON M.ID_MATERIA = I.ID_MATERIA
    WHERE M.ID_MATERIA IS NULL;

--MUESTRA TODAS LAS MATERIAS Y SI TIENEN ALUMNOS INSCRITOS
SELECT M.NOMBRE AS MATERIA, A.NOMBRE AS ALUMNO
FROM INSCRIPCION I
FULL JOIN ALUMNO A ON I.ID_ALUMNO = A.ID_ALUMNO 
RIGHT JOIN MATERIA M ON M.ID_MATERIA = I.ID_MATERIA;

--MUESTRAS TODOS LAS MATERIAS QUE NO TIENEN ALUMNOS INSCRITOS
SELECT M.NOMBRE AS MATERIA, A.NOMBRE AS ALUMNO
FROM INSCRIPCION I
RIGHT JOIN ALUMNO A ON I.ID_ALUMNO = A.ID_ALUMNO 
RIGHT JOIN MATERIA M ON I.ID_MATERIA = M.ID_MATERIA
WHERE I.ID_MATERIA IS NULL OR M.ID_MATERIA IS NULL;

--MUESTRAS TODOS LOS ALUMNOS Y TODAS LAS MATERIAS
SELECT A.NOMBRE AS ALUMNO, M.NOMBRE AS MATERIA
FROM INSCRIPCION I
FULL JOIN ALUMNO A ON I.ID_ALUMNO = A.ID_ALUMNO 
FULL JOIN MATERIA M ON M.ID_MATERIA = I.ID_MATERIA;

--MUESTRA LAS MATERIAS SIN ALUMNOS Y TODOS LOS ALUMNOS SIN MATERIAS
SELECT M.NOMBRE AS MATERIA, A.NOMBRE AS ALUMNO
FROM INSCRIPCION I
FULL JOIN ALUMNO A ON I.ID_ALUMNO = A.ID_ALUMNO 
FULL JOIN MATERIA M ON M.ID_MATERIA = I.ID_MATERIA
WHERE I.ID_MATERIA IS NULL;

SELECT M.NOMBRE AS MATERIA, A.NOMBRE AS ALUMNO
FROM INSCRIPCION I
FULL JOIN ALUMNO A ON I.ID_ALUMNO = A.ID_ALUMNO
FULL JOIN MATERIA M ON I.ID_MATERIA = M.ID_MATERIA
WHERE I.ID_ALUMNO IS NULL OR I.ID_MATERIA IS NULL;














